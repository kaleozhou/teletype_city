# 《终端·回响》游戏服务器启动说明

## 快速开始

### 1. 安装依赖
```bash
pip3 install pyyaml
```

### 2. 测试基本功能
```bash
python3 test_basic.py
```

### 3. 启动服务器
```bash
python3 start_server.py
```

### 4. 连接游戏
在另一个终端中：
```bash
telnet localhost 2323
```

## 游戏命令

### 基本命令
- `LOGIN <昵称>` - 登录游戏
- `LOOK` - 查看当前房间
- `GO N/S/E/W` - 移动方向
- `SAY <内容>` - 房间内发言
- `WHO` - 查看在线玩家
- `HELP` - 获取帮助
- `QUIT` - 退出游戏

### 快捷别名
- `N` = `GO N`
- `S` = `GO S`
- `E` = `GO E`
- `W` = `GO W`
- `"内容"` = `SAY 内容`

## 游戏世界

### 房间布局
```
        [灯塔下] [海滩]
           |        |
        [老码头] [电传机房]
           |        |
        [暗巷] [集市] [公告板]
           |        |
        [地下水道] [杂货店]
```

### 新手任务
1. 在老码头寻找【纸带】
2. 将纸带带到【电传机房】的技师处
3. 获得新手称号【报童】和20铆钉

## 故障排除

### 常见问题

1. **端口被占用**
   ```bash
   # 查看端口占用
   lsof -i :2323
   
   # 杀死占用进程
   kill -9 <PID>
   ```

2. **Python版本问题**
   ```bash
   # 确保使用Python 3.7+
   python3 --version
   ```

3. **依赖缺失**
   ```bash
   # 安装所有依赖
   pip3 install -r requirements.txt
   ```

### 日志查看
```bash
# 查看服务器日志
tail -f game_server.log

# 查看系统日志
sudo journalctl -u teletype-city -f
```

## 开发说明

### 项目结构
```
teletype_city/
├── server.py              # 主服务器
├── protocol.py            # 协议处理
├── commands.py            # 命令系统
├── world/                 # 游戏世界
│   ├── world_manager.py   # 世界管理
│   ├── room.py           # 房间系统
│   └── player.py         # 玩家系统
├── systems/               # 游戏系统
│   ├── player_manager.py  # 玩家管理
│   └── chat_manager.py    # 聊天系统
├── data/                  # 游戏数据
│   ├── rooms.yml         # 房间数据
│   ├── npcs.yml          # NPC数据
│   ├── items.yml         # 物品数据
│   └── quests.yml        # 任务数据
└── persist/               # 数据持久化
    └── storage.py        # 存储管理
```

### 扩展开发

1. **添加新房间**
   - 编辑 `data/rooms.yml`
   - 在 `world_manager.py` 中处理

2. **添加新命令**
   - 在 `commands.py` 中添加新方法
   - 在 `_register_commands()` 中注册

3. **添加新物品**
   - 编辑 `data/items.yml`
   - 在相关系统中处理

## 性能优化

### 服务器配置
- 调整 `tick_rate` 影响游戏响应速度
- 修改 `max_players` 限制同时在线人数
- 调整日志级别减少I/O开销

### 监控指标
- 在线玩家数量
- 每秒命令处理数
- 内存和CPU使用率
- 网络延迟

## 安全考虑

1. **输入验证**
   - 所有玩家输入都经过验证
   - 防止命令注入和恶意输入

2. **频率限制**
   - 聊天和命令都有冷却时间
   - 防止垃圾消息和DOS攻击

3. **数据保护**
   - 定期备份玩家数据
   - 敏感信息加密存储

## 联系支持

如果遇到问题，请：
1. 查看日志文件
2. 运行测试脚本
3. 检查配置文件
4. 提交Issue到项目仓库
